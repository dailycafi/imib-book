---
description: Cell Type Annotation
cover: >-
  https://images.unsplash.com/photo-1710002581130-8412bb50b02d?crop=entropy&cs=srgb&fm=jpg&ixid=M3wxOTcwMjR8MHwxfHNlYXJjaHwyfHxpZGVudGl0eXxlbnwwfHx8fDE3MzE5MTY2NDB8MA&ixlib=rb-4.0.3&q=85
coverY: 0
---

# 细胞类型注释

我们首先讨论单细胞的个体特征。细胞类型注释是通过单细胞数据识别并标注单个细胞的过程，具体而言，是根据基因表达特征识别细胞身份，并将具有相似特征的细胞进行聚类。这一过程在单细胞研究中占据重要地位。注释的本质是为细胞“打标签”，标签可以涵盖不同的细胞类型（如Kupffer细胞、肝星状细胞等）、不同的细胞亚群、细胞状态和功能特征等。

传统上，细胞类型注释的过程通常包括以下步骤：首先，通过差异表达分析识别出潜在的标记基因，并与已知的细胞类型标记基因进行比对，同时参考数据库和文献资料进行初步注释。接着，通过实验手段（如免疫染色、流式细胞术或原位杂交）验证特定标记物的表达。最后，结合研究背景和生物学知识对结果进行手动判断和调整。这种方法缺点是耗时长、依赖于标记基因的选择。

服务于细胞类型注释的计算工具， 已经使这一过程变得自动化和高效。以研究肝脏细胞为例，我们传统上需要手动筛选和分析大量单细胞RNA测序数据，识别差异表达的基因，并将这些基因与已知的肝脏细胞标记基因进行比对。这需要耗费大量时间、查阅文献和数据库，并依赖专业知识，是一个复杂且容易受到主观影响的过程。在数据量较少的情况下，人工方法可以完成这项任务；但随着数据量的增加，这种方法变得极为困难和耗时，并且再现性较差。相比之下，计算方法能够自动化地处理大量数据，在短时间内识别出细胞类型，并提供一致性更强的结果，这在大规模研究中尤为重要。

为了完成这样的任务，计算工具不仅需要自动化处理大规模数据中的[**降维**](#user-content-fn-1)[^1]、**聚类**、**差异表达分析**和**数据整合**等多个步骤，还需要确保能够高效地进行比对和注释。

目前，有一些已经广泛使用的计算工具， 像[**Seurat**](https://satijalab.org/seurat/)和[**Scanpy**](https://scanpy.readthedocs.io/en/stable/)**，** 他们集成了上面的过程， 特别擅长处理大规模的单细胞数据， 非常高效。

拿Seurat来举例（Scanpy作用类似， 只是用在另一种语言中）一个典型的使用他进行细胞类型注释到过程如下：

假设你我们正在研究肝脏细胞的异质性。你收集了来自不同患者或不同实验条件下的肝脏组织，经过单细胞RNA测序后，得到了一组包含成千上万细胞的基因表达数据。这些数据的维度非常高，每个细胞的基因表达量包含数千个基因的表达信息。

首先，你将这些数据作为输入加载到Seurat中。Seurat开始进行**数据预处理**，过滤掉低质量的细胞[^2]（比如，RNA质量差的细胞或细胞死掉的部分），并标准化[^3]每个细胞的基因表达数据，确保每个细胞之间具有可比性。

接下来，Seurat进行**降维**。由于数据维度非常高，Seurat通过主成分分析（PCA）将这些数据压缩成少数几个“主要成分”，有效减少了数据的复杂性，并保留了最能解释数据变异的信息。你现在可以更轻松地看到数据中的主要结构。

然后，Seurat执行**聚类分析**，自动将具有相似基因表达模式的细胞分为不同的群体。通过这种方式，Seurat识别出可能的细胞亚群体，例如不同类型的肝细胞、免疫细胞或肝星状细胞。这个过程通过[**Louvain聚类算法**](#user-content-fn-4)[^4]完成，聚类的结果会被保存为不同的“细胞簇”。

在这些细胞簇被标注之后，Seurat会进行**差异表达分析**，识别出每个簇特异性表达的基因。这些差异表达的基因就像是每个细胞群体的“名片”，是帮助你理解每个群体功能的重要线索。

最终，你将得到一组自动标注的细胞类型，Seurat通过与已知的肝脏细胞类型标记基因数据库进行比对，自动为每个簇分配一个细胞类型标签。例如，如果一个簇高表达肝星状细胞的标记基因（如ACTA2），Seurat会将这个簇标注为“肝星状细胞”。通过这种方法，你不再需要手动比对和查找标记基因，Seurat可以在短时间内完成这一过程。

最终，Seurat的输出包括：已注释的细胞类型、每个细胞群体的特征基因、聚类的可视化图（如UMAP或t-SNE图），以及标记基因的表达热图。我们可以通过这些结果，进一步分析不同细胞类型的功能特征、相互作用以及在不同实验条件下的变化。

**SingleR** 则是另一个侧重于自动注释的工具。它通过与预先构建的参考数据集比对，将新采集的细胞与已知的细胞类型进行匹配，类似于通过“身份对比”来识别新细胞的类型。与Seurat不同，SingleR不依赖于聚类，而是直接为每个细胞提供注释。然而，这种方法也有局限性，尤其是在面对稀有或未知细胞类型时，SingleR可能无法正确识别。此外，由于SingleR逐个比对细胞和参考数据集，它在面对大规模数据时可能会显得低效，并且在注释单个细胞时容易发生误标记。

因此，Seurat和SingleR通常可以结合使用，Seurat先进行聚类和差异表达分析，SingleR则提供进一步的注释和比对，以提高注释的准确性和效率。

然而，这些传统的计算工具在处理复杂、多变的细胞类型时，仍然存在一些不足。比如，它们难以准确捕捉细胞状态的动态变化（如细胞活化状态的变化），以及对新型或稀有细胞类型的识别能力有限。对于第一个问题，**我们需要结合**[**时间序列数据**](../dan-xi-bao-gui-ji-fen-xi-xin-fa/shi-xu-shu-ju-fen-xi-yu-zheng-he.md)**或**[**轨迹推断方法**](../dan-xi-bao-gui-ji-fen-xi-xin-fa/gui-ji-fen-xi-fang-fa-bi-jiao.md)， 这些方法可以帮助我们追踪细胞在不同状态下的变化过程，尤其是那些与细胞活化、分化相关的动态变化，这些内容我们会在后续章节介绍。而对于第二个问题，**我们需要依赖更加智能的计算方法，特别是各种深度学习模型**，这些方法能够通过从大量已标注数据中学习复杂的特征和模式，识别出从未见过的细胞类型或亚群。此外， 随着单细胞数据规模的持续增长，传统方法在处理超大规模数据集时面临效率瓶颈，特别是在需要整合多个大型数据集进行分析时， 我们需要更新的技术手段来解决这些问题。

\












[^1]: &#x20;常见的降维度， 如主成分分析， UMAP和t-SNE需要我展开讲么？

[^2]: 

    * **去除低质量细胞**：\
      单细胞RNA测序数据可能会受到一些低质量细胞的干扰，例如死细胞、破碎细胞或样本污染细胞。这些细胞的RNA质量较差，可能导致数据不准确，影响整体分析结果。清理低质量细胞有助于提高分析结果的可靠性和准确性。
    * **去除低表达基因**：\
      在单细胞数据中，一些基因的表达量非常低，可能是由于技术噪音或背景信号引起的。这些低表达基因往往没有生物学意义，清理掉这些基因可以减少数据的噪音，保留对细胞特征有意义的基因。
    * **避免数据偏差**：\
      如果细胞质量差异较大，直接分析可能会受到严重影响，导致错误的细胞群体分类。通过去除低质量细胞，我们可以确保数据更为一致，结果更具生物学代表性。

[^3]: 

    * **每个细胞的基因表达量除以其总表达量并进行对数转化**：\
      这种方法先计算每个细胞中所有基因表达量的总和，然后将每个基因的表达量除以细胞总表达量，得到一个相对表达值。为了避免数据的偏态分布，还会对这些值进行对数转化，使得数据更加符合正态分布，适合后续分析。
    * **回归去除批次效应**：\
      在不同实验中，由于测序技术或样本处理的差异，可能会引入批次效应。标准化过程中，还可以通过回归分析去除这些批次效应，从而使得不同批次的数据具有相同的分析基准。

[^4]: 想象你有10个小朋友，每个小朋友都和其他小朋友通过不同的绳子相连，连接的强度代表他们之间的相似性。你开始时把每个小朋友单独分开，然后根据他们之间的连接强度，逐步把最相似的小朋友拉到一起，直到他们分成几个“社交圈”，每个圈子内的小朋友之间有很多紧密的联系，而不同圈子之间的联系比较少。
